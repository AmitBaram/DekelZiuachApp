<Window x:Class="DekelApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:DekelApp.ViewModels"
        xmlns:views="clr-namespace:DekelApp.Views"
        mc:Ignorable="d"
        Title="Dekel" Height="675" Width="1080"
        MinWidth="900" MinHeight="576"
        WindowStartupLocation="CenterScreen"
        Background="Transparent"
        AllowsTransparency="True"
        WindowStyle="None"
        FlowDirection="RightToLeft"
        FontFamily="Segoe UI">
    
    <WindowChrome.WindowChrome>
        <WindowChrome CaptionHeight="40" 
                      CornerRadius="12"
                      GlassFrameThickness="0"
                      ResizeBorderThickness="8"/>
    </WindowChrome.WindowChrome>
    <Window.Resources>
        <DataTemplate DataType="{x:Type vm:TichumLayersViewModel}"><views:TichumLayersView /></DataTemplate>
        <DataTemplate DataType="{x:Type vm:FormatsViewModel}"><views:FormatsView /></DataTemplate>
        <DataTemplate DataType="{x:Type vm:TichumViewModel}"><views:TichumView /></DataTemplate>
        <DataTemplate DataType="{x:Type vm:YeadimViewModel}"><views:YeadimView /></DataTemplate>
        <DataTemplate DataType="{x:Type vm:GeneralInfoViewModel}"><views:GeneralInfoView /></DataTemplate>
        <DataTemplate DataType="{x:Type vm:FinishViewModel}"><views:FinishView /></DataTemplate>
    </Window.Resources>

    <Border x:Name="AppBorder"
            Background="{DynamicResource WindowBackgroundBrush}"
            BorderBrush="{DynamicResource BorderColorBrush}"
            BorderThickness="1"
            CornerRadius="12"
            ClipToBounds="True">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="40"/> <!-- Custom Title Bar Row -->
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Custom Title Bar -->
            <Grid Grid.Row="0" Background="{DynamicResource SidebarBackgroundBrush}">
                <TextBlock Text="Dekel" VerticalAlignment="Center" Margin="16,0"
                           FontSize="12" FontWeight="SemiBold" Opacity="0.5"
                           Foreground="{DynamicResource PrimaryTextBrush}"
                           HorizontalAlignment="Right"/>
                
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" WindowChrome.IsHitTestVisibleInChrome="True">
                    <Button x:Name="CloseBtn" Click="Close_Click" Width="46" Style="{StaticResource WindowControlButtonStyle}" Content="✕" Foreground="#E81123"/>
                    <Button x:Name="MaximizeBtn" Click="Maximize_Click" Width="46" Style="{StaticResource WindowControlButtonStyle}" Content="▢"/>
                    <Button x:Name="MinimizeBtn" Click="Minimize_Click" Width="46" Style="{StaticResource WindowControlButtonStyle}" Content="−"/>
                </StackPanel>
            </Grid>

            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="216"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Sidebar -->
                <Border Grid.Column="0"
                        Background="{DynamicResource SidebarBackgroundBrush}"
                        BorderBrush="{DynamicResource SidebarSeparationBrush}"
                        BorderThickness="0,0,1,0">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Logo & Brand -->
                        <Grid Grid.Row="0" Margin="20,25,20,30">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <!-- App Icon -->
                                <Border Width="40" Height="40" CornerRadius="10"
                                        Background="{DynamicResource LightBlueBrush}"
                                        BorderThickness="1" BorderBrush="{DynamicResource BorderColorBrush}"
                                        Margin="0,0,16,0">
                                    <Path Data="{StaticResource IconLayers}" Fill="{DynamicResource PrimaryBlueBrush}"
                                          Stretch="Uniform" Margin="9" Width="22" Height="22"/>
                                </Border>
                                <StackPanel VerticalAlignment="Center">
                                    <TextBlock Text="המצייח" 
                                               FontSize="24" 
                                               FontWeight="Black" 
                                               Foreground="{DynamicResource ModernGradientBrush}"
                                               Margin="0,0,0,-4"/>
                                    <TextBlock Text="ציוח מבצעי" 
                                               FontSize="11" 
                                               FontWeight="SemiBold"
                                               Foreground="{DynamicResource DeepChocolateBrush}" 
                                               Opacity="0.5"
                                               Margin="0,0,2,0"/>
                                </StackPanel>
                            </StackPanel>
                        </Grid>

                        <!-- Section label -->
                        <Border Grid.Row="1">
                            <StackPanel>
                                <TextBlock Text="ניווט" FontSize="10" FontWeight="SemiBold"
                                           Foreground="{DynamicResource SecondaryTextBrush}"
                                           Margin="20,0,20,8" Opacity="0.6"
                                           FlowDirection="RightToLeft"/>

                                <RadioButton Style="{StaticResource SidebarItemStyle}"
                                             Command="{Binding NavigateGeneralInfoCommand}"
                                             IsChecked="{Binding Navigation.CurrentViewModel, Mode=OneWay, Converter={StaticResource TypeToBooleanConverter}, ConverterParameter={x:Type vm:GeneralInfoViewModel}}">
                                    <StackPanel Orientation="Horizontal" Margin="12,0,0,0">
                                        <Path Data="{StaticResource IconGeneral}"
                                              Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=RadioButton}}"
                                              Width="18" Height="18" Stretch="Uniform"/>
                                        <TextBlock Text=" מידע כללי" VerticalAlignment="Center" FontSize="14" Margin="10,0,0,0"/>
                                    </StackPanel>
                                </RadioButton>

                                <RadioButton Style="{StaticResource SidebarItemStyle}"
                                             Command="{Binding NavigateFormatsCommand}"
                                             IsChecked="{Binding Navigation.CurrentViewModel, Mode=OneWay, Converter={StaticResource TypeToBooleanConverter}, ConverterParameter={x:Type vm:FormatsViewModel}}">
                                    <StackPanel Orientation="Horizontal" Margin="12,0,0,0">
                                        <Path Data="{StaticResource IconFormats}"
                                              Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=RadioButton}}"
                                              Width="18" Height="18" Stretch="Uniform"/>
                                        <TextBlock Text=" פורמטים" VerticalAlignment="Center" FontSize="14" Margin="10,0,0,0"/>
                                    </StackPanel>
                                </RadioButton>

                                <RadioButton Style="{StaticResource SidebarItemStyle}"
                                             Command="{Binding NavigateTichumCommand}"
                                             IsChecked="{Binding Navigation.CurrentViewModel, Mode=OneWay, Converter={StaticResource TypeToBooleanConverter}, ConverterParameter={x:Type vm:TichumViewModel}}">
                                    <StackPanel Orientation="Horizontal" Margin="12,0,0,0">
                                        <Path Data="{StaticResource IconTichum}"
                                              Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=RadioButton}}"
                                              Width="18" Height="18" Stretch="Uniform"/>
                                        <TextBlock Text=" תיחום" VerticalAlignment="Center" FontSize="14" Margin="10,0,0,0"/>
                                    </StackPanel>
                                </RadioButton>

                                <RadioButton Style="{StaticResource SidebarItemStyle}"
                                             Command="{Binding NavigateTichumLayersCommand}"
                                             IsChecked="{Binding Navigation.CurrentViewModel, Mode=OneWay, Converter={StaticResource TypeToBooleanConverter}, ConverterParameter={x:Type vm:TichumLayersViewModel}}">
                                    <StackPanel Orientation="Horizontal" Margin="12,0,0,0">
                                        <Path Data="{StaticResource IconLayers}"
                                              Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=RadioButton}}"
                                              Width="18" Height="18" Stretch="Uniform"/>
                                        <TextBlock Text=" שכבות תיחום" VerticalAlignment="Center" FontSize="14" Margin="10,0,0,0"/>
                                    </StackPanel>
                                </RadioButton>

                                <RadioButton Style="{StaticResource SidebarItemStyle}"
                                             Command="{Binding NavigateYeadimCommand}"
                                             IsChecked="{Binding Navigation.CurrentViewModel, Mode=OneWay, Converter={StaticResource TypeToBooleanConverter}, ConverterParameter={x:Type vm:YeadimViewModel}}">
                                    <StackPanel Orientation="Horizontal" Margin="12,0,0,0">
                                        <Path Data="{StaticResource IconYeadim}"
                                              Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=RadioButton}}"
                                              Width="18" Height="18" Stretch="Uniform"/>
                                        <TextBlock Text=" יעדים" VerticalAlignment="Center" FontSize="14" Margin="10,0,0,0"/>
                                    </StackPanel>
                                </RadioButton>
                            </StackPanel>
                        </Border>

                        <!-- Finish CTA -->
                        <Border Grid.Row="2"
                                BorderBrush="{DynamicResource SidebarSeparationBrush}"
                                BorderThickness="0,1,0,0"
                                Background="{DynamicResource SidebarBackgroundBrush}">
                            <Button Command="{Binding NavigateFinishCommand}"
                                    Margin="16,20,16,24" Height="48"
                                    Style="{StaticResource PrimaryButtonStyle}"
                                    Cursor="Hand">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="✓" FontSize="16" Margin="0,0,8,0" VerticalAlignment="Center" FontWeight="Bold"/>
                                    <TextBlock Text="סיום והפקה" VerticalAlignment="Center" FontWeight="Bold"/>
                                </StackPanel>
                            </Button>
                        </Border>
                    </Grid>
                </Border>

                <!-- Main Content -->
                <Grid Grid.Column="1">
                    <ScrollViewer VerticalScrollBarVisibility="Auto"
                                  HorizontalScrollBarVisibility="Disabled"
                                  Background="{DynamicResource WindowBackgroundBrush}">
                        <ContentControl Content="{Binding Navigation.CurrentViewModel}" Margin="40,32,40,32"/>
                    </ScrollViewer>
                    
                    <!-- Sidebar Shadow Transition -->
                    <Rectangle Width="10" HorizontalAlignment="Left" IsHitTestVisible="False">
                        <Rectangle.Fill>
                            <LinearGradientBrush StartPoint="0,0.5" EndPoint="1,0.5">
                                <GradientStop Color="#08000000" Offset="0"/>
                                <GradientStop Color="Transparent" Offset="1"/>
                            </LinearGradientBrush>
                        </Rectangle.Fill>
                    </Rectangle>
                </Grid>
            </Grid>
        </Grid>
    </Border>
</Window>
